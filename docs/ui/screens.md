# 画面構成

**作成日**: 2024年12月
**更新日**: 2025年12月

---

## 9.1 管理者画面

### ダッシュボード

- 発表会の進捗概要
  - マイルストーンの達成状況
  - タスク完了率（進捗バー）
  - 優先度別の未完了タスク数
- 未対応事項の一覧
  - 期日が近いタスク
  - ブロッカーが報告されているタスク
  - 未解決の質問
- 最近の更新履歴（監査ログから）
- クリティカルパスのハイライト

### 生徒・LINEアカウント管理

- 生徒情報の登録、編集、削除
- **アクセスコードの管理**（発行、再発行、無効化）
- パスキー発行・無効化（LINE未使用者向け）
- **生徒とLINEアカウントの紐づけ一覧**
  - どの生徒にどのLINEアカウントが紐づいているか
  - 関係（父・母・祖父母など）の確認
  - 主担当（is_primary）の確認・変更
- **LINE連携状況の確認**（友だち追加済み、登録完了など）
- **紐づけの手動追加・削除**（管理者による強制紐づけ）

### レッスン管理

**スケジュール管理**:

- 通常レッスンの定期スケジュール設定（曜日・時間・教室・クラス）
- カレンダー表示（月表示・週表示）
- 祝日・長期休暇の設定

**臨時レッスン管理**:

- 臨時レッスンの作成
  - 日時・場所の設定
  - 対象の選択（教室全体 / 特定クラス / 選択された生徒）
  - 応答締切の設定
- 臨時レッスンの一覧表示
- 応答状況の確認（参加/不参加/未回答）
- 未回答者へのリマインダー送信

**休校管理**:

- 休校の登録（日時・対象・理由）
- 振替レッスンの設定
- 確認状況の追跡

**出欠管理**:

- レッスンごとの出欠一覧
- 出欠統計（生徒別・期間別）
- 欠席連絡の確認

### 発表会管理

- 発表会の作成・編集
- **テンプレートからの作成**（過去の発表会をベースに）
- 演目の登録、順番の変更
- **マイルストーンの設定**
- キャスティング設定（演目×生徒×役名）
- 確定/未確定の切り替え

### 準備物・タスク管理

**多角的なビュー**:

- **リストビュー**: 詳細な情報の一覧表示
- **カンバンビュー**: ステータス別のカード表示（ドラッグ&ドロップ対応）
- **タイムラインビュー**: 期日ベースのガントチャート風表示
- **依存関係図**: タスク間の関係性を可視化

**タスク管理機能**:

- 準備物・タスクの作成（type, category, attributes を指定）
- **優先度の設定**（Critical / High / Medium / Low）
- **担当者・確認者の割り当て**
- **依存関係の設定**
- **完了条件（Definition of Done）の定義**
- 演目・役・生徒との関連付け
- ステータス定義のカスタマイズ
- 全体の進捗確認

**ブロッカー管理**:

- ブロッカーの一覧
- 解決状況の追跡
- ブロックされているタスクのハイライト

### コミュニケーション

- 保護者からのコメント・質問の確認
- 返信・解決済みマーク
- 問い合わせの多い項目の可視化

### 翻訳管理

- 翻訳の再生成
- 用語辞書の編集
- 翻訳履歴の確認

### LINE公式アカウント管理

- **リッチメニューの設定**
- **キーワード応答の設定**（キーワードと応答内容の管理）
- **ウェルカムメッセージの設定**
- LINEメッセージ履歴の閲覧

### 手動プッシュ通知

- **手動プッシュ通知の送信**（緊急時のみ使用）
  - 送信対象の選択（全員、教室別、発表会別、個人）
  - メッセージ内容の作成
  - 送信理由の記録
- プッシュ通知の送信履歴
- 通知テンプレートの編集

### テンプレート管理

- テンプレートの作成・編集
- 発表会からテンプレートを生成
- テンプレート項目の管理

### 変更履歴

- 監査ログの閲覧
- フィルタリング（期間、変更者、テーブル）
- 変更内容の詳細表示

## 9.2 保護者画面（LIFF アプリ）

LINE公式アカウントのリッチメニューからアクセスするLIFFアプリとして提供。

### アクセス方法

1. **リッチメニュー**: LINE公式アカウントのトーク画面下部に常時表示
2. **キーワード応答**: 特定のキーワードを送信するとLIFFリンクを返信
3. **Webブラウザ直接アクセス**: LINE未使用者向け（パスキー認証）

### 初回登録画面

LIFFアプリ初回起動時に表示。2つのモードを選択可能。

**新規登録モード（最初の保護者）**:
- 児童情報の登録（名前、教室）
- 自分と児童の関係を選択（母/父/祖父母/その他）
- 希望言語の選択
- LINE User IDと自動紐づけ
- **アクセスコードの表示**（他の保護者と共有用）

**アクセスコード入力モード（追加の保護者）**:
- アクセスコードを入力
- 自分と児童の関係を選択
- 希望言語の選択
- 既存の生徒に自分のLINEアカウントを紐づけ

### 子供を追加画面

既に1人以上の子供を登録済みの保護者向け。

**新規登録（兄弟姉妹の追加）**:
- 新しい児童情報の登録
- アクセスコードが自動発行される

**アクセスコード入力（既存の子供に追加）**:
- 他の保護者が登録済みの子供に紐づける場合
- アクセスコードを入力して紐づけ

### アクセスコード管理

登録済みの子供のアクセスコードを確認・共有。

- 子供ごとのアクセスコード表示
- **LINEで共有**ボタン（アクセスコードをメッセージで送信）
- アクセスコードの再発行（古いコードは無効化）
- 紐づけ済みの保護者一覧の確認

### マイページ（ホーム）

- 自分の子供に関する情報を一覧表示
- **今後のレッスン予定**（通常レッスン・臨時レッスン）
- **要対応事項**（臨時レッスンへの応答、休校確認など）
- 発表会の日程・会場
- 出演する演目・役（確定/未確定）
- 準備物のチェックリスト
- **マイルストーンまでの残り日数**
- **優先度の高いタスクのハイライト**
- **未読の更新通知**

### レッスンスケジュール

**カレンダー表示**:
- 自分の子供のレッスン予定を表示
- 通常レッスン（定期）
- 臨時レッスン（対象の場合のみ表示）
- 休校（対象の場合のみ表示）

**レッスン詳細**:
- 日時・場所・クラス
- 臨時レッスンの場合は説明文
- 応答状況（自分の子供のみ）

### 臨時レッスン応答

**臨時レッスン一覧**:
- 自分の子供が対象の臨時レッスンのみ表示
- 応答締切の表示
- 応答状況（参加予定/不参加/未回答）

**応答画面**:
- 参加/不参加の選択
- 備考の入力（任意）
- 応答の変更（締切前のみ）

**プライバシー保護**:
- 他の参加者の名前は表示されない
- 全体の集計数のみ表示（例: 参加12名、不参加3名）

### 休校確認

**休校連絡一覧**:
- 自分の子供に関係する休校連絡のみ表示
- 確認状況（確認済み/未確認）

**確認画面**:
- 休校の詳細（日時・理由）
- 振替情報（ある場合）
- 「確認しました」ボタン

### 欠席連絡

**欠席連絡の送信**:
- レッスンを選択
- 対象の子供を選択（複数いる場合）
- 理由の入力（任意）
- 送信確認

**欠席連絡履歴**:
- 送信済みの欠席連絡一覧
- ステータス（先生確認済み/未確認）

### 発表会詳細

- 日程、会場、プログラム（全演目の一覧）
- 自分の子供が出演する演目をハイライト
- 確定/未確定の明示
- **マイルストーンの一覧と進捗**

### 準備物一覧

**ビュー切替**:
- リスト表示（デフォルト）
- カンバン表示（ステータス別）
- タイムライン表示（期日順）

**機能**:
- 衣装・小道具のチェックリスト
- ステータス更新（ドロップダウン選択）
- 入手方法の選択（購入/手作り/貸出/手持ち）
- コメント投稿（質問・相談）
- **ブロッカーの報告**（「〇〇が理由で進められない」）
- **完了条件の確認**

### 担当タスク

- 裏方タスクの確認
- ステータス更新
- コメント投稿
- **依存関係の確認**（何を待っているか、何が待っているか）

### 設定

- 希望言語の変更（日本語 / 英語 / ロシア語）
- 児童情報の編集

### 変更履歴

- 自分に関連する変更の履歴
- 「最後に見てから何が変わったか」の表示

## 9.3 LINEメッセージ応答

LINE公式アカウントへのメッセージ送信時の自動応答（Reply Token使用）。

### キーワード応答例

| キーワード | 応答内容 |
|-----------|---------|
| 準備 | 準備物一覧のLIFFリンク |
| タスク | 担当タスク一覧のLIFFリンク |
| 確認 | マイページのLIFFリンク |
| 登録 | 児童情報登録画面のLIFFリンク |
| レッスン | 今後のレッスン予定のLIFFリンク |
| 臨時 | 未回答の臨時レッスン一覧のLIFFリンク |
| 休校 | 休校情報のLIFFリンク |
| 欠席 | 欠席連絡画面のLIFFリンク |
| ヘルプ | 使い方の説明テキスト |

### 未登録ユーザーへの応答

児童情報未登録のユーザーには、登録画面への導線を優先的に案内。

```
ご利用ありがとうございます。
まずはお子様の情報を登録してください。
→ [登録はこちら]
```
